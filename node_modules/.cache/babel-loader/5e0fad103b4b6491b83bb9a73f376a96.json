{"ast":null,"code":"var _jsxFileName = \"/home/noshu/react/test1/src/components/login/login.js\";\nimport React from \"react\";\nimport styled from \"styled-components\"; // import LoginBackground from \"../../../assets/backgrounds/loginBackground.svg\";\n\nimport { LoginForm } from \"./loginform\";\nimport { loginRequest } from \"../../../services/open/auth\";\nimport store from \"../../../redux/store\";\nimport { login } from \"../../../redux/slices/user-slice\";\nimport { Redirect, useLocation } from \"react-router-dom\";\n\nclass Login extends React.Component {\n  constructor(props) {\n    super(props);\n    this.subscription = [];\n\n    this.setFormData = formData => {\n      this.setState({ ...this.state,\n        loginForm: formData\n      });\n      this.subscription.push(loginRequest(this.state.loginForm).subscribe(res => {\n        store.dispatch(login(res.payload));\n        localStorage.setItem(\"token\", res.payload.token);\n        localStorage.setItem(\"role\", res.payload.role);\n        this.setState({\n          loggedIn: true,\n          role: res.payload.role\n        });\n      }));\n    };\n\n    this.state = {\n      loginForm: {\n        username: \"\",\n        password: \"\",\n        role: \"user\"\n      },\n      loggedIn: false\n    };\n    this.setFormData = this.setFormData.bind(this);\n  }\n\n  componentWillUnmount() {\n    this.subscription.map(sub => sub.unsubscribe());\n  }\n\n  render() {\n    let role = this.state.role;\n    return /*#__PURE__*/React.createElement(LoginContainer, {\n      className: \"container-fluid\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 41,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"row align-items-stretch\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 42,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"col-lg-6 col-md-8 col-12 border-right bg-white d-flex justify-content-center align-items-center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 43,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"content\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 44,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"h2\", {\n      className: \"text-success text-center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 45,\n        columnNumber: 15\n      }\n    }, \"Login\"), /*#__PURE__*/React.createElement(LoginForm, {\n      formSubmission: this.setFormData,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 46,\n        columnNumber: 15\n      }\n    })))), this.state.loggedIn && /*#__PURE__*/React.createElement(LoginRedirect, {\n      role: role,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 50,\n        columnNumber: 33\n      }\n    }));\n  }\n\n}\n\nexport const LoginContainer = styled.div`\n  min-height: 100vh;\n  background-repeat: no-repeat;\n  background-position: top right;\n  background-size: 100% auto;\n  .row {\n    min-height: 100vh;\n  }\n  @media (max-width: 768px) {\n    padding-top: 60px;\n  }\n`;\nexport const LoginRedirect = props => {\n  let location = useLocation();\n  let path = props.role === \"user\" ? \"/user/searchRide\" : \"/admin/dashboard\";\n  let {\n    from\n  } = location.state || {\n    from: {\n      pathname: path\n    }\n  };\n  console.log(from);\n  return /*#__PURE__*/React.createElement(Redirect, {\n    to: from,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 10\n    }\n  });\n};\nexport default Login;","map":{"version":3,"sources":["/home/noshu/react/test1/src/components/login/login.js"],"names":["React","styled","LoginForm","loginRequest","store","login","Redirect","useLocation","Login","Component","constructor","props","subscription","setFormData","formData","setState","state","loginForm","push","subscribe","res","dispatch","payload","localStorage","setItem","token","role","loggedIn","username","password","bind","componentWillUnmount","map","sub","unsubscribe","render","LoginContainer","div","LoginRedirect","location","path","from","pathname","console","log"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport styled from \"styled-components\";\n// import LoginBackground from \"../../../assets/backgrounds/loginBackground.svg\";\nimport { LoginForm } from \"./loginform\";\nimport { loginRequest } from \"../../../services/open/auth\";\nimport store from \"../../../redux/store\";\nimport { login } from \"../../../redux/slices/user-slice\";\nimport { Redirect, useLocation } from \"react-router-dom\";\nclass Login extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      loginForm: {\n        username: \"\",\n        password: \"\",\n        role: \"user\",\n      },\n      loggedIn: false,\n    };\n    this.setFormData = this.setFormData.bind(this);\n  }\n\n  subscription = [];\n  componentWillUnmount() {\n    this.subscription.map((sub) => sub.unsubscribe());\n  }\n  setFormData = (formData) => {\n    this.setState({ ...this.state, loginForm: formData });\n    this.subscription.push(\n      loginRequest(this.state.loginForm).subscribe((res) => {\n        store.dispatch(login(res.payload));\n        localStorage.setItem(\"token\", res.payload.token);\n        localStorage.setItem(\"role\", res.payload.role);\n        this.setState({ loggedIn: true, role: res.payload.role });\n      })\n    );\n  };\n  render() {\n    let role = this.state.role;\n    return (\n      <LoginContainer className=\"container-fluid\">\n        <div className=\"row align-items-stretch\">\n          <div className=\"col-lg-6 col-md-8 col-12 border-right bg-white d-flex justify-content-center align-items-center\">\n            <div className=\"content\">\n              <h2 className=\"text-success text-center\">Login</h2>\n              <LoginForm formSubmission={this.setFormData} />\n            </div>\n          </div>\n        </div>\n        {this.state.loggedIn && <LoginRedirect role={role} />}\n      </LoginContainer>\n    );\n  }\n}\n\nexport const LoginContainer = styled.div`\n  min-height: 100vh;\n  background-repeat: no-repeat;\n  background-position: top right;\n  background-size: 100% auto;\n  .row {\n    min-height: 100vh;\n  }\n  @media (max-width: 768px) {\n    padding-top: 60px;\n  }\n`;\n\nexport const LoginRedirect = (props) => {\n  let location = useLocation();\n  let path = props.role === \"user\" ? \"/user/searchRide\" : \"/admin/dashboard\";\n  let { from } = location.state || { from: { pathname: path } };\n  console.log(from);\n  return <Redirect to={from} />;\n};\n\nexport default Login;\n"]},"metadata":{},"sourceType":"module"}